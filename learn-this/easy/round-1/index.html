<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><title>Arriving at the Game Architecture stage</title><link rel="stylesheet" href="/css/normalize.css"><link rel="stylesheet" href="/css/header-footer.css"><link rel="stylesheet" href="/css/syntax.css"><link rel="stylesheet" href="/css/learn-this/learn-this-page.css"><link rel="icon" type="image/png" href="/images/favicon.png"><link href='http://fonts.googleapis.com/css?family=Titillium+Web:400,700,300,200' rel='stylesheet' type='text/css'> <script>!function(e,a,n,t,o,c,s){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=a.createElement(n),s=a.getElementsByTagName(n)[0],c.async=1,c.src=t,s.parentNode.insertBefore(c,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-40112459-1","joybox.io"),ga("send","pageview")</script><script src="/scripts/jquery-2.0.3.min.js"></script></head><body> <header> <nav> <a title="JOYBOX" href="/"><img src="/images/logo-header.png"></a><ul><li><a title="GET STARTED" href="/get-started">GET STARTED</a></li><li><a title="DOCUMENTATION" href="/documentation">DOCUMENTATION</a></li><li><a title="LEARN THIS" href="/learn-this">LEARN THIS</a></li><li><a title="HIGH SCORES" href="/high-scores">HIGH SCORES</a></li><li><a title="VERSION HISTORY" href="/version-history">VERSION HISTORY</a></li><li><a title="HELP" href="https://groups.google.com/forum/#!forum/joybox-wrapper">HELP</a></li></ul> </nav> </header><section id="title"><h1>Learn This!</h1> </section> <section id="blog"> <section id="theme" style="background:url('/images/tutorial-easy.png') no-repeat center 20px ,#600"><h4>Round 1: Tutorial<span>Game Architecture</span></h4><p>In this tutorial you will create your first Joybox project, then build an amazing main menu screen for your game and finally use a Scene for presenting it on the screen.</p> <a href="/learn-this/easy">Return to Easy Path</a> </section> <section id="content"><h4>DIRECTOR, SCENE, LAYER AND SPRITE</h4> <article><h2>Arriving at the Game Architecture stage</h2><p><p><img src="../../../images/learn-this/easy/round-1/game-screen.png" alt="Joybox Asteroids"/></p><p>In this path the game that we are going to create is a remake from a retro game from the year 1979: Asteroids! It will have some differences that you will notice along the way. But first lets get started by creating a Joybox project. Execute the following on your OSX terminal:</p><div class="highlight"><pre><code class="sh language-sh" data-lang="sh">motion create --template<span class="o">=</span>joybox-ios asteroids
</code></pre></div><p>This creates a regular RubyMotion project, with some differences:</p><ul><li><p>The director is already set up in the AppDelegate class.</p></li><li><p>Some assets are included in the resources folder, they are needed to present useful game statistics on the screen.</p></li></ul><p>The next thing we need to do is download the required assets for this tutorial: <a href="../../../downloads/learn-this/easy/round-1/assets.zip">Round 1 Assets</a>, and place them in the resources folder.</p><p>Before we start with the game, we need to tell <em>RubyMotion</em> that the app will be for <strong>iPad</strong> only. This is accomplished by updating the <em>RakeFile</em> as follows:</p><div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="vg">$:</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="s2">"/Library/RubyMotion/lib"</span><span class="p">)</span>
<span class="nb">require</span> <span class="s1">'motion/project/template/ios'</span>
<span class="nb">require</span> <span class="s1">'joybox'</span>

<span class="no">Motion</span><span class="o">::</span><span class="no">Project</span><span class="o">::</span><span class="no">App</span><span class="o">.</span><span class="n">setup</span> <span class="k">do</span> <span class="o">|</span><span class="n">app</span><span class="o">|</span>
  <span class="n">app</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'Asteroids'</span>

  <span class="c1"># Set the device family to iPad and the interface orientation to landscape left.</span>
  <span class="n">app</span><span class="o">.</span><span class="n">device_family</span> <span class="o">=</span> <span class="o">[</span><span class="ss">:ipad</span><span class="o">]</span>
  <span class="n">app</span><span class="o">.</span><span class="n">interface_orientations</span> <span class="o">=</span> <span class="o">[</span><span class="ss">:landscape_left</span><span class="o">]</span>

  <span class="c1"># Also set the icon that will be used in iOS Home Screen.</span>
  <span class="n">app</span><span class="o">.</span><span class="n">icons</span> <span class="o">=</span> <span class="o">[</span><span class="s1">'icon.png'</span><span class="p">,</span> <span class="s1">'icon@2x.png'</span><span class="o">]</span>
  <span class="n">app</span><span class="o">.</span><span class="n">prerendered_icon</span> <span class="o">=</span> <span class="kp">true</span>
<span class="k">end</span>
</code></pre></div><h3 id=menu>Menu</h3><p>Well, we are now ready to begin with our main menu! For this we need to create a subclass of <em>Layer</em>, which is principally used to present objects on the screen and receive the user interaction. Lets create a folder named <em>layers</em> inside the <strong>app</strong> folder, then add a new file with the name <em>menu_layer.rb</em> and finally type the following inside it:</p><div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">MenuLayer</span> <span class="o">&lt;</span> <span class="no">Joybox</span><span class="o">::</span><span class="no">Core</span><span class="o">::</span><span class="no">Layer</span>

    <span class="k">def</span> <span class="nf">on_enter</span>

    <span class="k">end</span>

<span class="k">end</span>
</code></pre></div><p><img class='more-info' src='/images/moreinfo.png'/> For more information about the Layers, see: <a href="../../../documentation/layer">Layer documentation page</a>.</p><p>In the previous code we are creating a subclass of Layer, named MenuLayer that will help us present two objects: The first will be the background of the menu and the other one will be the start button. Also notice that there is a method named <em>on_enter</em>. This method is going to get called when the Layer is presented on the screen, which is useful to initialize all the instances needed at the beginning of the layers life cycle.</p><p>The following step will place the menu's background image in the center of the layer. This is accomplished with the Sprite class. Sprites are regular two dimensional images that can be manipulated independently from others. Let's create one by adding the following code to the <em>on_enter</em> method:</p><div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">on_enter</span>
    <span class="n">background_sprite</span> <span class="o">=</span> <span class="no">Sprite</span><span class="o">.</span><span class="n">new</span> <span class="n">file_name</span><span class="p">:</span> <span class="s1">'sprites/menu/background.png'</span><span class="p">,</span>
                                                        <span class="ss">position</span><span class="p">:</span> <span class="no">Screen</span><span class="o">.</span><span class="n">center</span>

    <span class="nb">self</span> <span class="o">&lt;&lt;</span> <span class="n">background_sprite</span>
<span class="k">end</span>
</code></pre></div><p><img class='more-info' src='/images/moreinfo.png'/> For more information about the Sprites, see: <a href="../../../documentation/sprite">Sprite documentation page</a>.</p><p>With this we are creating a Sprite using the <strong>background.png</strong> image file and centering in the middle of the layer using the Screen class.</p><p>In order to render the Sprite on the screen it's required to add it to the layer. This is done by using the method <em>&lt;&lt;</em>, which you can notice in the last line.</p><h3 id=first-run>First Run</h3><p>In order to be shown, our Layer is required to be contained in a class called <em>Scene</em>. Scenes represent stages of our game like the Levels or in this case Menus. For now you can think of them as little minigames.</p><p><img class='more-info' src='/images/moreinfo.png'/> For more information about the Scenes, see: <a href="../../../documentation/scene">Scene documentation page</a>.</p><p>Now lets create another folder with the name <em>scenes</em> and inside it a file named <em>menu_scene.rb</em>. Finally add the following code to create a subclass of Scene:</p><div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">MenuScene</span> <span class="o">&lt;</span> <span class="no">Joybox</span><span class="o">::</span><span class="no">Core</span><span class="o">::</span><span class="no">Scene</span>

    <span class="k">def</span> <span class="nf">on_enter</span>

    <span class="k">end</span>

<span class="k">end</span>
</code></pre></div><p>The <em>on_enter</em> method works the same as with the layers, but in this case it will be called when the Scene is displayed. A perfect time to add our brand new MenuLayer to it:</p><div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">on_enter</span>
    <span class="n">menu_layer</span> <span class="o">=</span> <span class="no">MenuLayer</span><span class="o">.</span><span class="n">new</span>

    <span class="nb">self</span> <span class="o">&lt;&lt;</span> <span class="n">menu_layer</span>
<span class="k">end</span>
</code></pre></div><p>As you may notice, the scenes should contain layers and at the same time the layers should contain sprites.</p><div class='flag'><h5>Level Up!</h5><br/><p>This is the most standard architecture for the Game: Scenes << Layers << Sprites. On the other side that does not mean that you cannot adjust it to your game needs.</p></div><p>Finally we can tell the Director that we want it to present the MenuScene. The Director is the class that controls almost everything in the game, like: which scene should be presented or pause the game when a phone call enters.</p><p><img class='more-info' src='/images/moreinfo.png'/> For more information about the Director, see: <a href="../../../documentation/director">Director documentation page</a>.</p><p>If you open the <em>app_delegate.rb</em> file, you should see the following method:</p><div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">application</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="ss">didFinishLaunchingWithOptions</span><span class="p">:</span><span class="n">launchOptions</span><span class="p">)</span>

  <span class="vi">@director</span> <span class="o">=</span> <span class="no">Joybox</span><span class="o">::</span><span class="no">Configuration</span><span class="o">.</span><span class="n">setup</span> <span class="k">do</span>
    <span class="n">director</span> <span class="n">display_stats</span><span class="p">:</span> <span class="kp">true</span>
  <span class="k">end</span>

  <span class="vi">@navigation_controller</span> <span class="o">=</span> <span class="no">UINavigationController</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">initWithRootViewController</span><span class="p">(</span><span class="vi">@director</span><span class="p">)</span>
  <span class="vi">@navigation_controller</span><span class="o">.</span><span class="n">navigationBarHidden</span> <span class="o">=</span> <span class="kp">true</span>

  <span class="vi">@window</span> <span class="o">=</span> <span class="no">UIWindow</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">initWithFrame</span><span class="p">(</span><span class="no">UIScreen</span><span class="o">.</span><span class="n">mainScreen</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
  <span class="vi">@window</span><span class="o">.</span><span class="n">setRootViewController</span><span class="p">(</span><span class="vi">@navigation_controller</span><span class="p">)</span>
  <span class="vi">@window</span><span class="o">.</span><span class="n">makeKeyAndVisible</span>
  <span class="kp">true</span>
<span class="k">end</span>
</code></pre></div><p>This is the required set up for our game and for the purpose of this tutorial we will not look deeply into it. Just add the following line into the bottom of the method:</p><div class="highlight"><pre><code class="ruby language-ruby" data-lang="ruby">  <span class="o">.</span><span class="n">.</span><span class="o">.</span>

  <span class="c1"># With the following we tell the director to present the MenuScene when the game starts.</span>
  <span class="vi">@director</span> <span class="o">&lt;&lt;</span> <span class="no">MenuScene</span><span class="o">.</span><span class="n">new</span>
  <span class="kp">true</span>
<span class="k">end</span>
</code></pre></div><p>We are ready to run our game from the first time, which you can do by running the following command on your OSX terminal:</p><div class="highlight"><pre><code class="sh language-sh" data-lang="sh">rake
</code></pre></div><p>If everything succeeds you should see the following on your iOS Simulator:</p><p><img src="../../../images/learn-this/easy/round-1/first-run.png" alt="First Run"/></p><h3 id=round->Round 2</h3><p>With this we conclude the first round of the easy level! In the next round we finish our game menu learning how to add multiple layers into a scene and buttons to our game!</p><p><img class='more-info' src='/images/moreinfo.png'/> You can download the source code of this round from: <a href="../../../downloads/learn-this/easy/round-1/asteroids.zip">Easy Level - Round 1</a></p></p> </article><div class="next"><a href="/learn-this/easy/round-2">NEXT</a></div> </section> </section><section id="buildings"> <img src="/images/buildings-footer.png"> </section> <footer> <section id="container"> <img src="/images/star-footer.png"><p>Joybox is distributed under the terms of the MIT License<br>Design by: <a href="http://sandradelare.com/">Sandra de la Re</a></p> </section> </footer></body></html>